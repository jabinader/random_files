import { MatTableDataSource } from "@angular/material/table";
import { DefaultFilterValue } from "../enums/siren-table-filter-value.enum";
import { SirenDataSource } from './siren-datasource';
export class SirenFeDataSource extends SirenDataSource {
    constructor(data = [], config) {
        super();
        this.dataSource = new MatTableDataSource();
        if (data.length > 0) {
            this.loadData(data, config);
        }
        this.dataSource.connect().subscribe(data => {
            if (data) {
                this.paginatedData = data;
            }
        });
    }
    connect() {
        return this.dataSource.connect();
    }
    disconnect() {
        this.dataSource.disconnect();
    }
    getSize() {
        return this.size;
    }
    getPage() {
        return this.page;
    }
    getKeyword() {
        return this.keyword;
    }
    getSortColumn() {
        return this.sortColumn;
    }
    getSortDirection() {
        return this.sortDirection;
    }
    getCount() {
        return this.dataSource.filteredData.length;
    }
    isAllRowsSelected() {
        return this.paginatedData?.find(row => row.isSelected === false || row.isSelected === undefined) === undefined;
    }
    loadParams(config) {
        this.page = config?.page ?? DefaultFilterValue.DEFAULT_PAGE;
        this.size = config?.size ?? DefaultFilterValue.DEFAULT_PAGE_SIZE;
        this.sortColumn = config?.sortColumn ?? DefaultFilterValue.DEFAULT_SORT_COLUMN;
        this.sortDirection = config?.sortDirection ?? DefaultFilterValue.DEFAULT_SORT_DIRECTION;
        this.keyword = config?.keyword ?? DefaultFilterValue.DEFAULT_KEYWORD;
    }
    /**
     * Loads data in the table
     * @param data array of SirenTableData.
     * @param config optional object to set initial value for sorting and pagination.
     */
    loadData(data, config) {
        this.loadParams(config);
        this.data = data;
        this.checkSelectedRows();
        this.sendDataToTable();
        this.dataSource.filter = this.keyword;
    }
    /**
     * Sets the MatPaginator to enable client side pagination.
     */
    setPaginator(paginator) {
        this.dataSource.paginator = paginator;
    }
    /**
     * Sets MatSort to enable client side sorting.
     */
    setSort(sort) {
        this.dataSource.sort = sort;
    }
    /**
     * Sets page and size of the paginator. It doesn't trigger an ui change.
     * @param data object that contain page and size
     */
    updatePaginationParams(data) {
        this.page = data.page;
        this.size = data.size;
    }
    /**
     * Sets sort colummn and sort direction. It doesn't trigger an ui change.
     * @param data object that contain sortColumn and sortDirection
     */
    updateSortParams(data) {
        this.sortColumn = data.sortColumn;
        this.sortDirection = data.sortDirection;
    }
    filter(keywords) {
        this.page = DefaultFilterValue.DEFAULT_PAGE;
        this.keyword = keywords;
        this.dataSource.filter = keywords;
    }
    sendDataToTable() {
        this.dataSource.data = this.data;
    }
    selectAllRows() {
        this.paginatedData.forEach(row => {
            this.selectRow(row);
        });
    }
    /**
     *
     * @returns array filtered based on keyword in searchBox when allowFiltering input is true
     */
    getFilteredData() {
        return this.dataSource.filteredData;
    }
    /**
     * @returns array of current page data
     */
    getPaginatedData() {
        return this.paginatedData;
    }
    deselectAllRows(onlyPaginated = true) {
        const dataToDeleted = onlyPaginated ? this.paginatedData : this.data;
        dataToDeleted.forEach(row => this.deselectRow(row));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lyZW4tZmUtZGF0YXNvdXJjZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3RhYmxlL3NyYy9saWIvdGFibGUvZGF0YS1zb3VyY2Uvc2lyZW4tZmUtZGF0YXNvdXJjZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUU3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUc1RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFFckQsTUFBTSxPQUFPLGlCQUFrQixTQUFRLGVBQWU7SUFTbEQsWUFBWSxPQUF5QixFQUFFLEVBQUUsTUFBOEI7UUFDbkUsS0FBSyxFQUFFLENBQUM7UUFISixlQUFVLEdBQUcsSUFBSSxrQkFBa0IsRUFBa0IsQ0FBQztRQUkxRCxJQUFLLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQy9CO1FBQ0QsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDdkMsSUFBSSxJQUFJLEVBQUU7Z0JBQ04sSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7YUFDN0I7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFDRCxPQUFPO1FBQ0gsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ3JDLENBQUM7SUFFRCxVQUFVO1FBQ04sSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEVBQUUsQ0FBQztJQUNqQyxDQUFDO0lBQ00sT0FBTztRQUNWLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQztJQUNyQixDQUFDO0lBQ00sT0FBTztRQUNWLE9BQU8sSUFBSSxD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QyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3JCLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQztJQUNFOzs7T0FHRztJQUNJLGVBQWU7UUFDbEIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQztJQUN4QyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxnQkFBZ0I7UUFDbkIsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDO0lBQzlCLENBQUM7SUFFRyxlQUFlLENBQUMsYUFBYSxHQUFHLElBQUk7UUFDMUMsTUFBTSxhQUFhLEdBQUcsYUFBYSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQy9ELGFBQWEsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDM0QsQ0FBQztDQUVEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTWF0UGFnaW5hdG9yIH0gZnJvbSBcIkBhbmd1bGFyL21hdGVyaWFsL3BhZ2luYXRvclwiO1xuaW1wb3J0IHsgTWF0U29ydCwgU29ydERpcmVjdGlvbiB9IGZyb20gXCJAYW5ndWxhci9tYXRlcmlhbC9zb3J0XCI7XG5pbXBvcnQgeyBNYXRUYWJsZURhdGFTb3VyY2UgfSBmcm9tIFwiQGFuZ3VsYXIvbWF0ZXJpYWwvdGFibGVcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwicnhqc1wiO1xuaW1wb3J0IHsgRGVmYXVsdEZpbHRlclZhbHVlIH0gZnJvbSBcIi4uL2VudW1zL3NpcmVuLXRhYmxlLWZpbHRlci12YWx1ZS5lbnVtXCI7XG5pbXBvcnQgeyBTaXJlblRhYmxlRGF0YSB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL2RhdGEtdGFibGUubW9kZWxcIjtcbmltcG9ydCB7IFNpcmVuVGFibGVGaWx0ZXJNb2RlbCB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3NpcmVuLXRhYmxlLWZpbHRlci5tb2RlbFwiO1xuaW1wb3J0IHsgU2lyZW5EYXRhU291cmNlIH0gZnJvbSAnLi9zaXJlbi1kYXRhc291cmNlJztcblxuZXhwb3J0IGNsYXNzIFNpcmVuRmVEYXRhU291cmNlIGV4dGVuZHMgU2lyZW5EYXRhU291cmNle1xuXG4gICAgcHJpdmF0ZSBzaXplOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBwYWdlOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBrZXl3b3JkOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBzb3J0Q29sdW1uOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBzb3J0RGlyZWN0aW9uOiBTb3J0RGlyZWN0aW9uO1xuICAgIHByaXZhdGUgZGF0YVNvdXJjZSA9IG5ldyBNYXRUYWJsZURhdGFTb3VyY2U8U2lyZW5UYWJsZURhdGE+KCk7XG4gICAgcHJpdmF0ZSBwYWdpbmF0ZWREYXRhOiBTaXJlblRhYmxlRGF0YVtdO1xuICAgIGNvbnN0cnVjdG9yKGRhdGE6IFNpcmVuVGFibGVEYXRhW10gPSBbXSwgY29uZmlnPzogU2lyZW5UYWJsZUZpbHRlck1vZGVsKXtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKCBkYXRhLmxlbmd0aCA+IDAgKXtcbiAgICAgICAgICAgIHRoaXMubG9hZERhdGEoZGF0YSwgY29uZmlnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRhdGFTb3VyY2UuY29ubmVjdCgpLnN1YnNjcmliZShkYXRhID0+IHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWdpbmF0ZWREYXRhID0gZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbm5lY3QoKTogT2JzZXJ2YWJsZTxyZWFkb25seSBTaXJlblRhYmxlRGF0YVtdPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTb3VyY2UuY29ubmVjdCgpO1xuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGF0YVNvdXJjZS5kaXNjb25uZWN0KCk7XG4gICAgfVxuICAgIHB1YmxpYyBnZXRTaXplKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpemU7XG4gICAgfVxuICAgIHB1YmxpYyBnZXRQYWdlKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhZ2U7XG4gICAgfVxuICAgIHB1YmxpYyBnZXRLZXl3b3JkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXdvcmQ7XG4gICAgfVxuICAgIHB1YmxpYyBnZXRTb3J0Q29sdW1uKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRDb2x1bW47XG4gICAgfVxuICAgIHB1YmxpYyBnZXRTb3J0RGlyZWN0aW9uKCk6IFNvcnREaXJlY3Rpb24ge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0RGlyZWN0aW9uO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDb3VudCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU291cmNlLmZpbHRlcmVkRGF0YS5sZW5ndGg7XG4gICAgfVxuXG5cdHB1YmxpYyBpc0FsbFJvd3NTZWxlY3RlZCgpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdGhpcy5wYWdpbmF0ZWREYXRhPy5maW5kKHJvdyA9PiByb3cuaXNTZWxlY3RlZCA9PT0gZmFsc2UgfHwgcm93LmlzU2VsZWN0ZWQgPT09IHVuZGVmaW5lZCkgPT09IHVuZGVmaW5lZDtcblx0fVxuXG4gICAgcHJpdmF0ZSBsb2FkUGFyYW1zKGNvbmZpZzogU2lyZW5UYWJsZUZpbHRlck1vZGVsKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGFnZSA9IGNvbmZpZz8ucGFnZSA/PyBEZWZhdWx0RmlsdGVyVmFsdWUuREVGQVVMVF9QQUdFO1xuICAgICAgICB0aGlzLnNpemUgPSBjb25maWc/LnNpemUgPz8gRGVmYXVsdEZpbHRlclZhbHVlLkRFRkFVTFRfUEFHRV9TSVpFO1xuICAgICAgICB0aGlzLnNvcnRDb2x1bW4gPSBjb25maWc/LnNvcnRDb2x1bW4gPz8gRGVmYXVsdEZpbHRlclZhbHVlLkRFRkFVTFRfU09SVF9DT0xVTU47XG4gICAgICAgIHRoaXMuc29ydERpcmVjdGlvbiA9IGNvbmZpZz8uc29ydERpcmVjdGlvbiA/PyBEZWZhdWx0RmlsdGVyVmFsdWUuREVGQVVMVF9TT1JUX0RJUkVDVElPTjtcbiAgICAgICAgdGhpcy5rZXl3b3JkID0gY29uZmlnPy5rZXl3b3JkID8/IERlZmF1bHRGaWx0ZXJWYWx1ZS5ERUZBVUxUX0tFWVdPUkQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZHMgZGF0YSBpbiB0aGUgdGFibGVcbiAgICAgKiBAcGFyYW0gZGF0YSBhcnJheSBvZiBTaXJlblRhYmxlRGF0YS5cbiAgICAgKiBAcGFyYW0gY29uZmlnIG9wdGlvbmFsIG9iamVjdCB0byBzZXQgaW5pdGlhbCB2YWx1ZSBmb3Igc29ydGluZyBhbmQgcGFnaW5hdGlvbi5cbiAgICAgKi9cbiAgICBwdWJsaWMgbG9hZERhdGEoZGF0YTogU2lyZW5UYWJsZURhdGFbXSwgY29uZmlnPzogU2lyZW5UYWJsZUZpbHRlck1vZGVsKTogdm9pZCB7XG4gICAgICAgIHRoaXMubG9hZFBhcmFtcyhjb25maWcpO1xuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLmNoZWNrU2VsZWN0ZWRSb3dzKCk7XG4gICAgICAgIHRoaXMuc2VuZERhdGFUb1RhYmxlKCk7XG4gICAgICAgIHRoaXMuZGF0YVNvdXJjZS5maWx0ZXIgPSB0aGlzLmtleXdvcmQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgTWF0UGFnaW5hdG9yIHRvIGVuYWJsZSBjbGllbnQgc2lkZSBwYWdpbmF0aW9uLlxuICAgICAqL1xuICAgIHB1YmxpYyBzZXRQYWdpbmF0b3IocGFnaW5hdG9yOiBNYXRQYWdpbmF0b3IpIHtcbiAgICAgICAgdGhpcy5kYXRhU291cmNlLnBhZ2luYXRvciA9IHBhZ2luYXRvcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyBNYXRTb3J0IHRvIGVuYWJsZSBjbGllbnQgc2lkZSBzb3J0aW5nLlxuICAgICAqL1xuICAgIHB1YmxpYyBzZXRTb3J0KHNvcnQ6IE1hdFNvcnQpOiB2b2lkIHtcblx0XHR0aGlzLmRhdGFTb3VyY2Uuc29ydCA9IHNvcnQ7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgcGFnZSBhbmQgc2l6ZSBvZiB0aGUgcGFnaW5hdG9yLiBJdCBkb2Vzbid0IHRyaWdnZXIgYW4gdWkgY2hhbmdlLlxuICAgICAqIEBwYXJhbSBkYXRhIG9iamVjdCB0aGF0IGNvbnRhaW4gcGFnZSBhbmQgc2l6ZVxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGVQYWdpbmF0aW9uUGFyYW1zKGRhdGE6IFNpcmVuVGFibGVGaWx0ZXJNb2RlbCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBhZ2UgPSBkYXRhLnBhZ2U7XG4gICAgICAgIHRoaXMuc2l6ZSA9IGRhdGEuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyBzb3J0IGNvbHVtbW4gYW5kIHNvcnQgZGlyZWN0aW9uLiBJdCBkb2Vzbid0IHRyaWdnZXIgYW4gdWkgY2hhbmdlLlxuICAgICAqIEBwYXJhbSBkYXRhIG9iamVjdCB0aGF0IGNvbnRhaW4gc29ydENvbHVtbiBhbmQgc29ydERpcmVjdGlvblxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGVTb3J0UGFyYW1zKGRhdGE6IFNpcmVuVGFibGVGaWx0ZXJNb2RlbCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNvcnRDb2x1bW4gPSBkYXRhLnNvcnRDb2x1bW47XG4gICAgICAgIHRoaXMuc29ydERpcmVjdGlvbiA9IGRhdGEuc29ydERpcmVjdGlvbjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZmlsdGVyKGtleXdvcmRzOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wYWdlID0gRGVmYXVsdEZpbHRlclZhbHVlLkRFRkFVTFRfUEFHRTtcbiAgICAgICAgdGhpcy5rZXl3b3JkID0ga2V5d29yZHM7XG4gICAgICAgIHRoaXMuZGF0YVNvdXJjZS5maWx0ZXIgPSBrZXl3b3JkcztcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc2VuZERhdGFUb1RhYmxlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmRhdGFTb3VyY2UuZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB9XG5cblx0cHVibGljIHNlbGVjdEFsbFJvd3MoKTogdm9pZCB7XG5cdFx0dGhpcy5wYWdpbmF0ZWREYXRhLmZvckVhY2gocm93ID0+IHtcblx0XHRcdHRoaXMuc2VsZWN0Um93KHJvdyk7XG5cdFx0fSk7XG5cdH1cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcmV0dXJucyBhcnJheSBmaWx0ZXJlZCBiYXNlZCBvbiBrZXl3b3JkIGluIHNlYXJjaEJveCB3aGVuIGFsbG93RmlsdGVyaW5nIGlucHV0IGlzIHRydWVcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0RmlsdGVyZWREYXRhKCk6IFNpcmVuVGFibGVEYXRhW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU291cmNlLmZpbHRlcmVkRGF0YTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyBhcnJheSBvZiBjdXJyZW50IHBhZ2UgZGF0YSBcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UGFnaW5hdGVkRGF0YSgpOiBTaXJlblRhYmxlRGF0YVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFnaW5hdGVkRGF0YTtcbiAgICB9XG5cblx0cHVibGljIGRlc2VsZWN0QWxsUm93cyhvbmx5UGFnaW5hdGVkID0gdHJ1ZSk6IHZvaWQge1xuXHRcdGNvbnN0IGRhdGFUb0RlbGV0ZWQgPSBvbmx5UGFnaW5hdGVkID8gdGhpcy5wYWdpbmF0ZWREYXRhIDogdGhpcy5kYXRhO1xuICAgICAgICBkYXRhVG9EZWxldGVkLmZvckVhY2gocm93ID0+IHRoaXMuZGVzZWxlY3RSb3cocm93KSk7XG5cdH1cblxufSJdfQ==